# 5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения

## Задача 1

Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

При аппаратной виртуализации гостевые ОС полностью изолированы друг от дурга и не привязаны к архитектуре хоста (так как виртуализируется само "железо" для гостя). Гостевая ОС может использовать почти все ресурсы хоста.  
При паравиртуализации гостевые ОС должны быть "заточены" под работу в слое виртуализации. Не могут выйти по потреблению ресурсов за заданный гипервизором лимит. Любое обращение к аппаратным ресурсам происходит через обращение к софту гипервизора.  
При виртуализации на основе ОС контейнеры могут использовать све ресурсы хоста, но могут быть и ограничены. Главное ограничение - контейнер должен использовать то же ядро, что и хостовая ОС.

## Задача 2

Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.

Организация серверов:
- физические сервера,
- паравиртуализация,
- виртуализация уровня ОС.

Условия использования:
- Высоконагруженная база данных, чувствительная к отказу.
- Различные web-приложения.
- Windows системы для использования бухгалтерским отделом.
- Системы, выполняющие высокопроизводительные расчеты на GPU.

Опишите, почему вы выбрали к каждому целевому использованию такую организацию.

Ответ:  
- Высоконагруженная база данных, чувствительная к отказу.  
Из предложенных вариантов - физические сервера. Но на практике чаще работал с вариантом размещения в среде аппаратной виртуализации, что позволяет уменьшить дайнтаймы БД для окон обсулживания физики.
- Различные web-приложения.  
Виртуализация уровня ОС. При таком подходе будет меньше накладных расходов на виртуализацию аппартной части и полноценной гостевой ОС, что позволит больше ресурсов отдать под целевую задачу.
- Windows системы для использования бухгалтерским отделом.  
Паравиртуализация. У себя вообещ переводим всех сотрудников (постепенно) на VDI. Это позволяет лучше следить за гомогенностью клиентских машин в плане обновлений. Упрощает бэкап машин ключевых сотрудников. При налчии ресурса - позволяет быстро "проапгрейдить" рабочее место, добавив мощностей.
- Системы, выполняющие высокопроизводительные расчеты на GPU.  
Физические сервера. В случае рассчётов на GPU все возможные системы виртуализации либо вообще не дадут нормально использовать ресурс видеопроцессора, либо будут узким горлышком в работе.

## Задача 3

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.  
Ответ: раз в задаче упоминается, что много MS - значит имеются деньги. Так что можно попробовать предложить VMWare с vSphere. Если денег жалко, то Proxmox и oVirt.
2. Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.  
Ответ: при работе на 1 хосте - KVM. При наличии многих хостов я бы выбирал между Proxmox и oVirt.
3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.  
Ответ: Microsoft Hyper-V
4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.  
Ответ: думаю, что KVM.

## Задача 4

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.  
Ответ: к сожалению, на своем текущем месте работы имею как раз такую картину. В работе одновременно трудятся и VMWare 5.5-6 в двух vSpher'ах, а также арендованное облако с 7 версией. Имеется 2 кластера oVirt 4.1 и 4.4.2. Есть на поддержке и Proxmox (не вспомню сходу версию) и ещё штук 15 одиночных KVM'ок.  
Самый главный минус, что очень сложно весь этот зоопарк обслуживать:
- фактически надо иметь как минимум несколько специалистов для распределения отвественности. Так как сейчас я один просто не могу иметь компетенции по каждому из продуктов;
- следить за обновлениями и производить их (Если это возможно; привет импортозамещение - пока обновление старушки вари 5.5)  
Создавал бы я гетерогенную среду? Думаю да. Но всё равно из родственных продуктов. Как например - для каких-то некластеризируемых решений простой и достаточно надёжный KVM, для кластеров - очень понравился Proxmox. Ну и опять же, в нашу жизнь всё плотнее входит контейнеризация. Даже у нас - в госе.